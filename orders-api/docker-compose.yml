services:
  mongo:
    image: mongo:latest
    restart: unless-stopped
    ports:
      - "27018:27017"
    environment:
      - MONGO_INITDB_DATABASE=${MONGO_DB:-demo}
    volumes:
      - ./mongo-init:/docker-entrypoint-initdb.d:ro
      - mongo_data:/data/db
  # rabbit ya est√° corriendo desde products-api, comentado para evitar conflicto
  # rabbit:
  #   image: rabbitmq:3-management
  #   container_name: rabbit
  #   restart: unless-stopped
  #   ports:
  #     - "5672:5672"    # AMQP
  #     - "15672:15672"  # Panel web
  #   environment:
  #     RABBITMQ_DEFAULT_USER: ${RABBITMQ_USER:-admin}
  #     RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASS:-admin}
  #   healthcheck:
  #     test: ["CMD", "rabbitmq-diagnostics", "ping"]
  #     interval: 10s
  #     timeout: 5s
  #     retries: 5

volumes:
  mongo_data: